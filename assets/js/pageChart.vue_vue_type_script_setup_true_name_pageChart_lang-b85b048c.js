import{u as a}from"./useApi-5ac496ff.js";import{e as t,f as e,_ as i,o as s,a as o,b as l,c as n,Q as r,J as d}from"./@vue_runtime-core@3.2.47-c6dbaf88.js";import{r as p,u as c,i as m}from"./@vue_reactivity@3.2.47-57d9983b.js";const u={class:"page_chart"},b={class:"user_echarts_content"},y={class:"table_content"},f=t({...t({name:"pageChart"}),setup(t){const{proxy:f}=a(),g=p({border:!0,firstColumn:{type:"index",label:"序列"},data:[],columns:[{prop:"name",label:"页面名称",minWidth:"120"},{prop:"url",label:"URL",minWidth:"220"},{prop:"personAmount",label:"UV访问用户数",minWidth:"140",sort:!0},{prop:"viewTime",label:"PV访问次数",minWidth:"120",sort:!0},{prop:"residence",label:"平均停留时长（秒）",minWidth:"160",sort:!0},{prop:"share",label:"分享次数",minWidth:"160",sort:!0}]}),h=p({}),v=p({}),x=p({}),w=p(0),_=a=>{V(w.value)};e((()=>{setTimeout((()=>{D()}),2e3)}));const D=async()=>{await V(w.value),await L(),await P(),await W()},V=async a=>{const t=await f.$api.getVisitData();if(t.success){const e=t.data[a].dataList.map((e=>({type:"line",smooth:!0,name:t.data[a].type||"",data:e.data,label:{normal:{show:!0,position:"top"}}}))),i=t.data[a].nameData,s={title:{text:t.data[a].title},tooltip:{trigger:"axis"},legend:{data:i},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:{type:"category",boundaryGap:!1,data:t.data[a].keyData},yAxis:{type:"value"},series:e};h.value=s}},L=async()=>{const a=await f.$api.getPageVisitData();if(a.success){const t=a.data.dataList.map((a=>({type:"bar",...a,label:{normal:{show:!0,position:"top"}}}))),e=a.data.nameData,i={title:{text:a.data.title},tooltip:{trigger:"axis"},legend:{data:e},grid:{left:"5%",bottom:"3%",containLabel:!0},xAxis:{type:"category",data:a.data.keyData,name:a.data.xtitle,axisLabel:{interval:0,rotate:40}},yAxis:{type:"value",name:a.data.ytitle},series:t};v.value=i}},P=async()=>{const a=await f.$api.getPaymentConversion();if(a.success){const t=a.data.dataList.map((a=>({type:"funnel",left:"10%",width:"90%",maxSize:"90%",label:{position:"inside",formatter:"{c}人",color:"#fff"},itemStyle:{opacity:.8,borderColor:"#fff",borderWidth:2},emphasis:{label:{position:"inside",formatter:"{b}: {c}人"}},...a,data:a.topData}))),e=a.data.nameData,i={title:{text:a.data.title},tooltip:{trigger:"item",formatter:"{b} : {c}人"},legend:{x:"center",y:"bottom",data:e},series:t};x.value=i}},W=async()=>{const a=await f.$api.listPageDetails();a.success&&(g.value.data=a.data)};return(a,t)=>{const e=i("el-radio-button"),p=i("el-radio-group"),f=i("t-chart"),D=i("t-table");return s(),o("div",u,[l("div",b,[n(f,{options:c(h),class:"accessPage"},{default:r((()=>[n(p,{class:"access_type",modelValue:c(w),"onUpdate:modelValue":t[0]||(t[0]=a=>m(w)?w.value=a:null),size:"small",onChange:_},{default:r((()=>[n(e,{label:0},{default:r((()=>[d("UV数据")])),_:1}),n(e,{label:1},{default:r((()=>[d("PV数据")])),_:1})])),_:1},8,["modelValue"])])),_:1},8,["options"]),n(f,{options:c(v)},null,8,["options"]),n(f,{options:c(x)},null,8,["options"])]),l("div",y,[n(D,{title:"页面详情",table:c(g),columns:c(g).columns,isShowPagination:!1},null,8,["table","columns"])])])}}});export{f as _};
