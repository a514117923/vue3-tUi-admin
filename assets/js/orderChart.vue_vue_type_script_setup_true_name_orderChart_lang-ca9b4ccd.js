import{u as t}from"./useApi-5ac496ff.js";import{M as a}from"./map-d6b1e3c9.js";import{e,f as o,_ as i,o as s,a as l,b as n,c as r,Q as d,J as p}from"./@vue_runtime-core@3.2.47-c6dbaf88.js";import{r as c,u}from"./@vue_reactivity@3.2.47-57d9983b.js";import{O as m}from"./@vue_shared@3.2.47-177e1703.js";const v={class:"order_chart"},y={class:"echarts_content"},b={class:"content_top"},g={class:"content_bottom"},x={class:"order_quantity_map"},f={class:"map_top"},h={class:"title"},w={class:"tip"},L={class:"map"},_={id:"OrderQuantity",ref:"OrderQuantity"},D={class:"replaceBox",title:"刷新"},A={class:"table_content"},$=e({...e({name:"orderChart"}),setup(e){const{proxy:$}=t(),k=c({border:!0,data:[],columns:[{prop:"orderNo",label:"订单编号",minWidth:"120"},{prop:"address",label:"客户信息",minWidth:"330",render:(t,a)=>r("div",null,[a.customerName,p(" "),a.customerPhone,p(" "),t])},{prop:"orderAmount",label:"订单总额",minWidth:"140"},{prop:"reductionAmount",label:"订单优惠总额",minWidth:"120"},{prop:"payAmount",label:"支付金额",minWidth:"140"},{prop:"createTime",label:"创建时间",minWidth:"160"}]}),O=c({}),j=c({}),F=c({}),T=c({}),W=c({}),P=c(null),z=c([]),M=c([]);o((()=>{Q()}));const Q=()=>{S(),V(),C(),G(),N(),q()},S=async()=>{const t=await $.$api.getSaleTrendData();if(t.success){const a=t.data.dataList.map((t=>({type:"line",smooth:!0,...t,label:{normal:{show:!0,position:"top"}}}))),e=t.data.nameData,o={title:{text:t.data.title},tooltip:{trigger:"axis"},legend:{data:e},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:{type:"category",boundaryGap:!1,data:t.data.keyData},yAxis:{type:"value"},series:a};O.value=o}},V=async()=>{const t=await $.$api.getOrderTimeData();if(t.success){const a=t.data.dataList.map((t=>({type:"line",smooth:!0,...t,label:{normal:{show:!0,position:"top"}}}))),e=t.data.nameData,o={title:{text:t.data.title},tooltip:{trigger:"axis"},legend:{data:e},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:{type:"category",boundaryGap:!1,data:t.data.keyData},yAxis:{type:"value"},series:a};j.value=o}},C=async()=>{const t=await $.$api.getPayResultData();if(t.success){const a=t.data.dataList.map((t=>({...t}))),e={title:{text:t.data.title},tooltip:{trigger:"item",formatter:"{b}:{d}% \n 订单数量: {c}"},series:{type:"pie",radius:"80%",label:{normal:{show:!0,position:"inner",textStyle:{align:"center",baseline:"middle"},formatter:"{b}:{d}% \n 订单数量: {c}"}},data:a}};F.value=e}},G=async()=>{const t=await $.$api.getAmountDistributionData();if(t.success){const a=t.data.dataList.map((t=>({type:"bar",...t,label:{normal:{show:!0,position:"top"}}}))),e=t.data.nameData,o={title:{text:t.data.title},tooltip:{trigger:"axis"},legend:{data:e},grid:{left:"5%",bottom:"3%",containLabel:!0},xAxis:{type:"category",data:t.data.keyData,name:t.data.xtitle},yAxis:{type:"value",name:t.data.ytitle},series:a};T.value=o}},N=async()=>{var t;const e=await $.$api.getLocationDistributionData();e.success&&(null==(t=P.value)||t.clearMap(),W.value=e.data,z.value=[e.data.store.amapLon,e.data.store.amapLat],a().then((t=>{P.value=new t.Map("OrderQuantity",{resizeEnable:!0,zoom:12,center:z.value})})),M.value=e.data.streetVOList,M.value.push(e.data.store),M.value=M.value.filter((t=>""!=t.amapLon&&null!=t.amapLon)),W.value.streetVOList.length>0&&await R())},R=()=>{for(let t=0;t<M.value.length;t+=1){let e=[M.value[t].amapLon,M.value[t].amapLat];const o=M.value[t].storeType?"#ff3d00":"#1d6fec",i=`<div class="custom-content-marker marker"><img src="//a.amap.com/jsapi_demos/static/demo-center/icons/poi-marker-${M.value[t].storeType?"red":"default"}.png" style="width:25px;height:34px;"/>  <div style="color:#fff;position: absolute;font-size: 12px;top: 5px;" class="num">${M.value[t].count||""} </div></div>`;a().then((a=>{let s=new a.Marker({position:e,offset:new a.Pixel(-13,-30),content:i,title:`${M.value[t].street}`,zIndex:102});const l=`<div style="background: ${o};opacity:'0.8';padding: 0 5px;border-radius: 4px;box-shadow:0 2px 4px 0 rgba(0,0,0,0.16)">\n            <div style="color: #FFFFFF;">${M.value[t].storeType?"当前门店":M.value[t].street}</div>\n          </div>`;s.setLabel({direction:"top",offset:new a.Pixel(0,0),
// 设置文本标注偏移量
content:l}),P.value.add(s),P.value.setZoom(18),P.value.setFitView()}))}},Z=()=>{N()},q=async()=>{const t=await $.$api.pageOrderData();t.success&&(k.value.data=t.data)};return(t,a)=>{const e=i("t-chart"),o=i("Refresh"),p=i("el-icon"),c=i("t-table");return s(),l("div",v,[n("div",y,[n("div",b,[r(e,{options:u(O)},null,8,["options"]),r(e,{options:u(j)},null,8,["options"])]),n("div",g,[r(e,{options:u(F)},null,8,["options"]),r(e,{options:u(T)},null,8,["options"]),n("div",x,[n("div",f,[n("div",h,m(u(W).title),1),n("div",w,m(u(W).tip),1)]),n("div",L,[n("div",_,null,512),n("div",D,[r(p,{onClick:Z},{default:d((()=>[r(o)])),_:1})])])])])]),n("div",A,[r(c,{title:"订单详情",table:u(k),columns:u(k).columns,isShowPagination:!1},null,8,["table","columns"])])])}}});export{$ as _};
